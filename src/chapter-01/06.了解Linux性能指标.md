## 了解 Linux 性能指标
在我们了解 Linux 操作系统中的各种调优参数和性能度量工具之前，有必要讨论各种可用的指标及其与系统性能相关的意义。因为这是一个开源操作系统，所以有很多性能度量工具可用。您最终选择的工具将取决于您的个人偏好以及所需的数据量和详细信息。尽管有许多可用的工具，但所有的性能度量实用程序都度量相同的指标，因此理解这些指标使您能够使用遇到的任何实用程序。因此，我们只讨论最重要的指标。还有许多更详细的值可能对详细分析有用，但它们超出了本文的范围。

### 处理器指标
以下是处理器指标：

CPU 利用率（utilization）
:	这可能是最直接的度量。它描述了每个处理器的总体利用率。在 IBM System x 体系结构上，如果 CPU 利用率连续一段时间超过 80%，就可能出现处理器瓶颈。

用户时间（User time）
:	描述花费在用户进程上的 CPU 百分比，包括 nice 时间。较高的用户时间值通常是可取的，因为在这种情况下，系统执行实际工作。

系统时间（System time）
:	描述内核操作花费的 CPU 百分比，包括 IRQ（中断请求） 和软中断（_softirq_）时间。高且持续的系统时间值表明网络和驱动程序堆栈中可能存在瓶颈。系统通常应该在内核时间上花费尽可能少的时间。

等待（Waiting）
:	等待 I/O 操作的 CPU 总时间。与阻塞（_blocked_）值一样，系统不应该花费太多时间等待 I/O 操作；否则，您应该检查 I/O 子系统各方面的性能。

空闲时间（Idle time）
:	描述系统空闲等待任务的 CPU 百分比。

Nice 时间（Nice time）
:	描述花费在 _re-nicing_ （用于更改进程执行顺序和优先级）进程上的 CPU 百分比。

平均负载（Load average）
:	平均负载值不是一个百分比，而是以下各项之和的滚动平均值：
	- 队列中等待执行的进程数
	- 等待不可中断任务完成的进程数

	即 TASK_RUNNING 进程和 TASK_UNINTERRUPTIBLE 进程之和的平均值。如果请求 CPU 时间的进程被阻塞（这意味着 CPU 没有时间处理它们），平均负载将增加。另一方面，如果每个进程都能立即访问 CPU 时间，并且没有错过 CPU 周期，负载就会降低。

可运行进程（Runable processes）
:	此值描述准备执行的进程。在一段持续的时间内，该值不应超过物理处理器数量的 10 倍；否则就可能出现处理器瓶颈。

阻塞（Blocked）
:	在等待 I/O 操作完成时无法执行的进程。阻塞的进程可能指向 I/O 瓶颈。

上下文切换（Context switch）
:	系统上发生的线程之间切换的数量。大量的上下文切换与大量的中断有关，可能表示驱动程序或应用程序存在问题。上下文切换通常是不可取的，因为每次切换都会刷新 CPU 缓存，但某些上下文切换是必要的。请参阅 1.1.5 节 “上下文切换”。

中断（Interrupts）
:	中断值包括硬中断和软中断。硬中断对系统性能的影响更大。高中断值是软件瓶颈的指示，无论是在内核还是驱动程序中。请记住，中断值包括由 CPU 时钟引起的中断。请参阅 1.1.6 节“中断处理”。

### 内存指标
以下是内存指标：

空闲内存
:	与大多数其他操作系统相比，Linux 中的空闲内存值不应该引起关注。正如在 1.2.2 节 “虚拟内存管理器” 中所解释的，Linux 内核将大部分未使用的内存分配为文件系统缓存，因此从已使用的内存中减去缓冲区和缓存的数量来确定（实际的）空闲内存。

交换空间使用（Swap usage）
:	此值描述所使用的交换空间量。正如 1.2.2 节中的 “虚拟内存管理器” 所描述的，交换的使用情况只告诉您 Linux 真正有效地管理内存。Swap 换入/换出（In/Out） 是识别内存瓶颈的可靠方法。持续一段时间内每秒超过 200 到 300 页的值表示可能存在内存瓶颈。

缓冲与缓存（Buffer and cache）
:	分配给文件系统和块设备的缓存。

Slabs
:	描述内核内存使用情况。注意，不能将内核页换出到磁盘。

活动与非活动内存（Active versus inactive memory）
:	为您提供有关系统内存的积极使用的信息。不活动内存很可能被 kswapd 守护进程换出到磁盘。请参阅 1.2.2 节的 “页框回收”。

### 网络接口指标
网络接口指标如下：

已收到和已传送的封包（Packets received and sent）
:	这个指标告诉您特定网络接口接收和发送的数据包的数量。

已收到和已传送的字节（Bytes received and sent）
:	此值描述给定网络接口接收和发送的字节数。

每秒冲突数（Collisions per second）
:	这个值指示了各个接口所连接的网络上发生的冲突的数量。持续的冲突值通常与网络基础设施中的瓶颈有关，而不是服务器。在大多数正确配置的网络上，冲突是非常罕见的，除非网络基础设施由集线器组成。

丢包（Packets dropped）
:	这是由于防火墙配置或缺少网络缓冲区而被内核丢弃的包的计数。

Overruns
:	Overruns（溢出）表示网络接口耗尽缓冲区空间的次数。这个指标应该与丢包（_Packets dropped_）值一起使用，以识别网络缓冲区或网络队列长度中可能的瓶颈。

错误（Errors）
:	标记为错误的帧数。这通常是由网络不匹配或部分损坏的网线造成的。对于基于铜的千兆网络来说，部分损坏的网线可能是一个重要的性能问题。

### 块设备指标
下面是块设备指标：

IO 等待（Iowait）
:	CPU 等待 I/O 操作发生的时间。高且持续的值很可能表明存在 I/O 瓶颈。

平均队列长度（Average queue length）
:	未处理的 I/O 请求数量。一般来说，2 到 3 个磁盘队列是最优的；较高的值可能指向磁盘 I/O 瓶颈。

平均等待时间（Average wait）
:	对 I/O 请求得到服务所花费的平均时间（以毫秒为单位）的度量。等待时间由实际的 I/O 操作和它在 I/O 队列中等待的时间组成。

每秒传输量（Transfers per second）
:	描述每秒执行多少个 I/O 操作（读和写）。_Transfers per second_ 指标与 _kBytes per second_ 值一起帮助您确定系统的平均传输大小。平均传输大小通常应该与磁盘子系统使用的条带大小匹配。

每秒读写块数量（Blocks read/write per second）
:	这个指标描述了在内核 2.6 中以 1024 字节的块表示的每秒读和写。早期的内核可能会报告不同的块大小，从 512 字节到 4kb。

每秒读写千字节树（Kilobytes per second read/write）
:	对块设备的读和写（以千字节为单位）表示在块设备上和在块设备上传输的实际数据量。