## Linux 文件系统
作为开源操作系统，Linux 的一大优点是它为用户提供了各种受支持的文件系统。现代 Linux 内核几乎可以支持计算机系统曾经使用过的所有文件系统，从基本的 FAT 支持到高性能文件系统如日志文件系统（_journaling file system_  JFS）。但是，因为 Ext2, Ext3 和 ReiserFS 是大多数 Linux 发行版支持的原生 Linux 文件系统（ReiserFS 仅在 Novell SUSE Linux 上获得商业支持），我们将重点讨论它们的特点，并只概述其他常用的 Linux 文件系统。

有关文件系统和磁盘子系统的更多信息，请参阅 4.6 节 “优化磁盘子系统”。

### 虚拟文件系统
虚拟文件系统 (VFS) 是驻留在用户进程和各种类型的 Linux 文件系统实现之间的抽象接口层。VFS 提供了常用的对象模型（如 i-node、文件对象、页面缓存、目录条目等）和访问文件系统对象的方法。它对用户进程隐藏了每个文件系统实现的差异。由于 VFS，用户进程不需要知道使用哪个文件系统，或者应该为每个文件系统发出哪个系统调用。[@fig:vfs_concept] 说明了 VFS 的概念。

![VFS 概念](images/vfs_concept.jpg){#fig:vfs_concept}

### 日志
在非日志（_non-journaling_）文件系统中，当对文件系统执行写操作时，Linux 内核首先对文件系统元数据（_metadata_）进行更改，然后再写入实际的用户数据。这种操作有时会增加丢失数据完整性的可能性。如果在对文件系统元数据进行写操作时，系统因某种原因突然崩溃，可能会破坏文件系统的一致性。_fsck_ 通过检查所有元数据来修复不一致，并在下次重启时恢复一致性。但是当系统的容量较大时，需要花费大量的时间才能完成。在此过程中，系统无法运行。

日志（_Journaling_）文件系统通过在将数据写入实际文件系统之前将要更改的数据写入称为日志区域（_journaling area_）的区域来解决这个问题。日志区域可以放在文件系统中，也可以放在文件系统之外。写入日志区域的数据称为日志记录（_journal log_）。它包括对文件系统元数据和实际文件数据（如果支持的话）的更改。

由于日志在将实际用户数据写入文件系统之前需要写入 journal log，因此与没有日志记录的文件系统相比，日志记录可能导致性能开销。为了保持更高的数据一致性牺牲了多少性能开销，这取决于在写入用户数据之前向磁盘写入了多少信息。我们将在 1.3.4 节 “Ext3” 中讨论这个主题。

![日志概念](images/journaling_concept.jpg){#fig:journaling_concept}

### Ext2

### Ext3

### ReiserFS

### 日志文件系统

### XFS
